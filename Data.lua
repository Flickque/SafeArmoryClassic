local a=SafeArmory;local b=a.L;a.fnc={}a.dataCount=0;if not a then return end;a.classID={["NONE"]=0,["WARRIOR"]=1,["PALADIN"]=2,["HUNTER"]=3,["ROGUE"]=4,["PRIEST"]=5,["DEATHKNIGHT"]=6,["SHAMAN"]=7,["MAGE"]=8,["WARLOCK"]=9,["MONK"]=10,["DRUID"]=11,["DEMONHUNTER"]=12}a.raceID={["None"]=0,["Human"]=1,["Orc"]=2,["Dwarf"]=3,["NightElf"]=4,["Undead"]=5,["Tauren"]=6,["Gnome"]=7,["Troll"]=8,["Goblin"]=9,["BloodElf"]=10,["Draenei"]=11,["Worgen"]=2,["Pandaren"]=23,["Nightborne"]=27,["HighmountainTauren"]=28,["VoidElf"]=29,["LightforgedDraenei"]=30,["ZandalariTroll"]=31,["KulTiran"]=32,["DarkIronDwarf"]=34,["Vulpera"]=35,["MagharOrc"]=36,["Mechagnome"]=37}a.equipCategories={[1]="AMMOSLOT",[2]="HEADSLOT",[3]="NECKSLOT",[4]="SHOULDERSLOT",[5]="SHIRTSLOT",[6]="CHESTSLOT",[7]="WAISTSLOT",[8]="LEGSSLOT",[9]="FEETSLOT",[10]="WRISTSLOT",[11]="HANDSSLOT",[12]="FINGER0SLOT",[13]="FINGER1SLOT",[14]="TRINKET0SLOT",[15]="TRINKET1SLOT",[16]="BACKSLOT",[17]="MAINHANDSLOT",[18]="SECONDARYHANDSLOT",[19]="RANGEDSLOT",[20]="TABARDSLOT"}a.standings={"Unknown","Hated","Hostile","Unfriendly","Neutral","Friendly","Honored","Revered","Exalted"}function a:dump(c)if type(c)=='table'then local d='{ 'for e,f in pairs(c)do if type(e)~='number'then e='"'..e..'"'end;d=d..'['..e..'] = '..a:dump(f)..','end;return d..'} 'else return tostring(c)end end;local function g(c)if type(c)=='table'then for e,f in pairs(c)do a.dataCount=a.dataCount+1;g(f)end else return tostring(c)end;return tostring(a.dataCount)end;function isEmpty(d)return d==nil or d==''or not d end;function a.fnc:x(h)return GetContainerNumSlots(h)end;function a.fnc:y(h,d)return Item:CreateFromBagAndSlot(h,d)end;function a.fnc:_z(f)if f then return f:IsItemEmpty()else return nil end end;function a.fnc:idg(f)if f then return f:GetItemID()else return nil end end;function a.fnc:s_bn()return NUM_BAG_SLOTS end;function a.fnc:s_bbn()return NUM_BANKBAGSLOTS end;local j;local function k()if not j then j=CreateFrame("GameTooltip","SaScanningTooltip",nil,"GameTooltipTemplate")j:SetOwner(UIParent,"ANCHOR_NONE")end;return j end;local function l(m,n,o)local j=k()j:ClearLines()if m then j:SetBagItem(m,n)elseif n then j:SetInventoryItem("player",n)else j:SetHyperlink(o)end;return j end;local function p(m,n,o)local q=_G["ITEM_LEVEL"]:gsub("%%d","(%%d+)")local r=l(m,n,o)local s={}local t={r:GetRegions()}for i,u in ipairs(t)do if u and u:GetObjectType()=="FontString"then local v=u:GetText()if v then s[#s+1]=v;ilvl=tonumber(v:match(q))end end end;return s end;function a:GetPlayerData()local s={}local w,x=UnitClass("player")local y,z=UnitRace("player")local A,B=UnitFactionGroup("player")local C={copper=0,silver=0,gold=0}local D=GetMoney()local E,F,G=GetPVPLifetimeStats()s.name=UnitName("player")s.realm=GetRealmName()s.level=UnitLevel("player")s.gender=UnitSex("player")-1;s.faction=A;s.money=D;s.pvprank=UnitPVPRank("player")s.highestRank=G;s.classID=a.classID[x]s.raceID=a.raceID[z]s.locale=GetLocale()s.guid=UnitGUID("player")s.stats={}s.stats.strength=UnitStat("player",1)s.stats.agility=UnitStat("player",2)s.stats.stamina=UnitStat("player",3)s.stats.intellect=UnitStat("player",4)s.stats.spirit=UnitStat("player",5)s.stats.health=UnitHealthMax("player")s.stats.mana=UnitPowerMax("player",0)return s end;local function H(I)local J={}local K,I,L,M,N,O,P,Q,R,S,T=GetItemInfo(I)local U={}local V=string.match(I,"|Hitem:([\-%d:]+)|")if not V then return nil end;local W={strsplit(":",V)}J.id=W[1]J.name=K;J.isItemEquippable=IsEquippableItem(I)J.type=O;J.subtype=P;J.rarity=L;if J.isItemEquippable then J.gems={W[3],W[4],W[5],W[6]}J.color=Color;J.lvl=M;J.itemMinLevel=N;J.enchat=W[2]J.stats=GetItemStats(I,U)J.bonus=W[14]end;return J end;local function X()local Y=0;local Z=GetContainerNumSlots(Y)local a0=1;return function()while Y<5 do local J=Item:CreateFromBagAndSlot(Y,a0)local _,_,_,_,_,_,I=GetContainerItemInfo(Y,a0)local j=p(Y,a0,I)a0=a0+1;if a0>Z then Y=Y+1;a0=1;Z=GetContainerNumSlots(Y)end;if not J:IsItemEmpty()then J.tooltip=j;return J end end end end;local function a1()local Y=-1;local Z=GetContainerNumSlots(Y)local a0=1;return function()while Y<=NUM_BAG_SLOTS+NUM_BANKBAGSLOTS do local J=Item:CreateFromBagAndSlot(Y,a0)local _,a2,_,_,_,_,I=GetContainerItemInfo(Y,a0)local j=p(Y,a0,I)a0=a0+1;if a0>Z then if Y==-1 then Y=NUM_BAG_SLOTS+1 else Y=Y+1 end;a0=1;Z=GetContainerNumSlots(Y)end;if not J:IsItemEmpty()then J.count=a2;J.tooltip=j;return J end end end end;function a:GetBagItemsData()local a3={}local a4={}for J in X()do local a5=J:GetItemID()if not a4[a5]then a4[a5]=true;local _,I=GetItemInfo(a5)local a6=H(I)a6.count=GetItemCount(a5,false,false)a6.tooltip=J.tooltip;a3[#a3+1]=a6 end end;return a3 end;function a:GetBankItemsData()local a3={}local a4={}for J in a1()do local a5=J:GetItemID()if not a4[a5]then a4[a5]={count=1,itemsID=#a3+1}local _,I=GetItemInfo(a5)local a6=H(I)a6.count=J.count;a6.tooltip=J.tooltip;a3[#a3+1]=a6 else a4[a5].count=a4[a5].count+1;if a3[a4[a5].itemsID].count then a3[a4[a5].itemsID].count=J.count+a3[a4[a5].itemsID].count end end end;return a3 end;function a:GetTalentsData()local a7={}local a8=GetNumTalentTabs()for c=1,a8 do a7[c]={name={},talents={},talentsMap={{0,0,0,0},{0,0,0,0},{0,0,0,0},{0,0,0,0},{0,0,0,0},{0,0,0,0},{0,0,0,0}}}local a9=GetTalentTabInfo(c)a7[c].name=a9;local aa=GetNumTalents(c)for i=1,aa do nameTalent,_,tier,column,currRank,maxRank=GetTalentInfo(c,i)a7[c].talentsMap[tier][column]=currRank..'/'..maxRank;a7[c].talents[i]={}a7[c].talents[i].name=nameTalent;a7[c].talents[i].rank=currRank;a7[c].talents[i].maxrank=maxRank;a7[c].talents[i].place=tier..','..column end end;return a7 end;function a.GetReputationsData()local ab={faction={}}local ac=1;for ad=1,GetNumFactions()do name,description,standingId,bottomValue,topValue,earnedValue,atWarWith,canToggleAtWar,isHeader,isCollapsed,hasRep,isWatched,isChild=GetFactionInfo(ad)if ab.faction[ac]==nil then ab.faction[ac]={subfaction={}}end;if isHeader then ab.faction[ac].name=name;ab.faction[ac].standingId=a.standings[standingId+1]ab.faction[ac].currentValue=earnedValue-bottomValue;ab.faction[ac].currentTopValue=topValue-bottomValue;ac=ac+1;i=1 else ab.faction[ac-1].subfaction[i]={}ab.faction[ac-1].subfaction[i].name=name;ab.faction[ac-1].subfaction[i].standingId=a.standings[standingId+1]ab.faction[ac-1].subfaction[i].currentValue=earnedValue-bottomValue;ab.faction[ac-1].subfaction[i].currentTopValue=topValue-bottomValue;i=i+1 end end;table.remove(ab.faction)return ab end;function a:GetProfessionsData()local ae=""local af=""local ag=""local ah=0;for i=1,GetNumSkillLines()do local ai,isHeader,_,aj,_,_,ak=GetSkillLineInfo(i)if isHeader then ah=ah+1;if ah==2 then ae=ai elseif ah==3 then af=ai elseif ah==4 then ag=ai end end end;local al={primary=a.LibProfessions:GetProfessions(ae),secondary=a.LibProfessions:GetProfessions(af),weapon_skills=a.LibProfessions:GetProfessions(ag)}return al end;function a:GetEquippedItemsData()local a3={}for i=1,#a.equipCategories,1 do slotID=GetInventorySlotInfo(a.equipCategories[i])if GetInventoryItemLink("player",slotID)then local I=GetInventoryItemLink("player",slotID)local am=H(I)am.tooltip=p(false,slotID,I)a3[a.equipCategories[i]]=am else a3[a.equipCategories[i]]={}end end;return a3 end;function a:GetBagBankCounts()local an={bag=#a:GetBagItemsData(),bank=#a:GetBankItemsData()}return an end;function a:GetAllData()local s={}s['equipment']=a:GetEquippedItemsData()s['bag']=a:GetBagItemsData()s['bank']=a:GetBankItemsData()s['professions']=a:GetProfessionsData()s['reputations']=a:GetReputationsData()s['talents']=a:GetTalentsData()s['info']=a:GetPlayerData()s['counts']=a:GetBagBankCounts()s['security']=a:Security()return s end;function a:CountData(s)return g(s)end